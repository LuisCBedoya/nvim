set -g default-shell /usr/bin/zsh
setw -g xterm-keys on

setw -g mode-keys vi
set -g mouse on

# set -as terminal-overrides ",alacritty*:Tc"
set -ga terminal-overrides ",alacritty*:Ms=\E]52;c;%p1%s\E\\"

# statusbar
set -g status-position top
set -g status-justify right
set -g status-interval 1
set -g status-right-length 10
setw -g window-status-separator ""
set -g status-style bg=terminal
set -g status-bg terminal
set -g status-fg "#ffffff"
set -g set-clipboard on
set -g allow-passthrough on

set-window-option -g mode-style bg=colour8,fg=white
set -g message-style bg=black,fg=white
setw -g window-status-format "#[bg=black,fg=colour8]#[bg="#363a4f",fg=terminal] #I #[bg="#363a4f",fg=terminal]#W #[bg=black,fg=colour8, nobold]"
setw -g window-status-current-format "#[bg=terminal,fg=black]#[bg="#8aadf4",fg="#2a223f",bold] #I #[bg="#8aadf4",fg="#2a223f",bold]#W #[bg=terminal,fg=black, bold]"
set -g status-right '#[bg=colour8,fg=terminal]#{?client_prefix,  •  ,}'
set -g status-justify left

# Set title for actual terminal-emulator
set -g set-titles on
set -g set-titles-string "#W"

# If running inside tmux ($TMUX is set), then change the status line to red
%if #{TMUX}
set -g status-bg red
%endif

# Scrollback history limit
set -g history-limit 10000
set-window-option -g visual-bell off
set-window-option -g bell-action any
set -g remain-on-exit off
set -g renumber-windows on

#set-window-option -g pane-border-status top
#set-window-option -g pane-border-format "#[align=left]#[fg=dim]─ #{s|$HOME|~|:pane_current_path} ─"
set -g pane-active-border-style fg=terminal,bold
set -g pane-border-style fg=colour8,dim,overline

##############
# change prefix
#############
# set -g prefix C-b
# bind C-Space send-prefix
set -g prefix C-b
bind C-b send-prefix

##############
# unbind
#############
unbind %
unbind \"
unbind x
unbind &
# unbind C-b
unbind c
unbind n
unbind p
unbind u


##############
# key tmux
#############

#####
#  Navegation
#####
###### Navegation between tabs
bind -n M-o select-window -n

#####
#  create
#####
# bind-key -n C-t new-window
bind -n C-k new-window
bind k new-window
##### Create panels
# bind enter split-window -h -c "#{pane_current_path}"
bind , split-window -v -c "#{pane_current_path}"
bind . split-window -h -c "#{pane_current_path}"

#####
#  close
#####
# bind-key -n C-w if-shell '[ "$(tmux list-panes | wc -l)" -gt 1 ]' 'kill-pane' 'kill-window'
bind -n M-q if-shell '[ "$(tmux list-panes | wc -l)" -gt 1 ]' 'kill-pane' 'kill-window'

#####
#  resize
#####
######  resize panels
bind h resize-pane -L 5
bind j resize-pane -D 5
bind k resize-pane -U 5
bind l resize-pane -R 5

#####
#  rename
#####
bind -n M-n command-prompt "rename-window '%%'"

#####
#  copy-mode
#####
## open mode vim
bind -n M-u if-shell -F '#{pane_in_mode}' 'send-keys q' 'copy-mode'
#### copy text or buffer
# bind-key -T copy-mode-vi 'y' send -X copy-selection
bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel "tmux load-buffer -w -"
#### paste text or buffer
# bind -n M-p run-shell "tmux send-keys -l \"$(tmux show-buffer)\""
bind -n M-p paste-buffer
### Visual toggle
set -g @visual_mode "off"
bind -T copy-mode-vi v run-shell '
  if [ "$(tmux show -gqv @visual_mode)" = "line" ]; then
    tmux set -g @visual_mode "char"
    tmux send -X select-pane
    tmux send -X begin-selection
  else
    tmux set -g @visual_mode "line"

    tmux send -X select-line
  fi
'
bind -T copy-mode-vi q run-shell 'tmux set -g @visual_mode "off"; tmux send -X cancel'
bind -T copy-mode-vi Escape run-shell 'tmux set -g @visual_mode "off"; tmux send -X cancel'

#####
#  synchronize
#####
bind -n M-c set synchronize-panes
